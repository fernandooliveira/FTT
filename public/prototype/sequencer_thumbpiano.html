<!DOCTYPE html>
<html>
<head>
  <title>Sequencer</title>
  
  <link href="../css/webcss/reset.css" media="all" rel="stylesheet" type="text/css"/>
  <link href="../css/webcss/forms.css" media="all" rel="stylesheet" type="text/css"/>
  <link href="../css/webcss/column.css" media="all" rel="stylesheet" type="text/css"/>
  <link href="../css/webcss/states.css" media="all" rel="stylesheet" type="text/css"/>
  <link href="../css/webcss/layer.css" media="all" rel="stylesheet" type="text/css"/>
  <link href="../css/webdoc/site.typography.css" media="all" rel="stylesheet" type="text/css"/>
  
  <style>
    
    .button_bar {
    	margin: 10em auto;
    	width: 66%;
    }
    
    .button {
    	-webkit-border-radius: 24px;
    	-moz-border-radius:    24px;
    	border-radius:         24px;
    	
    	background: rgba(80,80,80,0.8);
    	padding: 0.4em 1.3em;
    	font-size: 1.2em;
    	font-weight: bold;
    	color: white;
    	margin-right: 0.4em;
    	white-space: nowrap;
    	
			-webkit-transition: -webkit-box-shadow 1s ease-out;

			-webkit-box-shadow: none;
			-webkit-box-shadow: none;
			-moz-box-shadow:    none;
			box-shadow:         none;
    }
    
    .go_button {
    	background: orange;
    	margin-right: 2em;
    	opacity: 0.4;
    }
    
    .ping {
    	-webkit-border-radius: 24px;
    	-moz-border-radius:    24px;
    	border-radius:         24px;
    	
    	background: rgb(225,225,225);
    	display: inline-block;
    	width: 48px;
    	height: 48px;
    	margin-right: 32px;
    	white-space: nowrap;
    	
			-webkit-transition: -webkit-box-shadow 0.6s ease-out, background-color 0.3s ease-out;

			-webkit-box-shadow: none;
			-webkit-box-shadow: none;
			-moz-box-shadow:    none;
			box-shadow:         none;
    }
    
    .active {
			-webkit-transition: -webkit-box-shadow 0.05s ease-in, background-color 0.05s ease-in;
			
			background-color: orange;
			
			-webkit-box-shadow: 0 0 8px orange;
			-webkit-box-shadow: 0 0 8px 6px orange;
			-moz-box-shadow:    0 0 8px 6px orange;
			box-shadow:         0 0 8px 6px orange;
    }
    
    #content {
    	font-size: 1.6em;
    	width: 66%;
    	margin: 0 auto;
    	color: #666666;
    }
  </style>
</head>
<body class="loading">
  
  <div class="button_bar">
  
  	<a href="#go" class="go_button button">Click me</a>
  	<br /><br /><br />
  	<a class="ping" id="fing"></a>
  	<a class="ping" id="fang"></a>
  	<a class="ping" id="fong"></a>
  	<a class="ping" id="fung"></a>
  	<a class="ping" id="feng"></a>
  	<a class="ping" id="foo"></a>
	
	</div>

  <div id="content"></div>
  
  <div class="loading_icon screen_layer layer"></div>
  
  <script src="../js/jquery-1.4.2.js"></script>
  <script src="js/sequencer.js"></script>
  <script src="js/sequencer.processes.DOM.js"></script>
  <script>
	
	var n1 = {
		type: 'audio',
		src: 'audio/25046__radian__Kalimba_note1_preview.mp3',
		end: 500,
		10: [{ type: 'addClass', selector: '#fing', className: 'active' }],
		100: [{ type: 'removeClass', selector: '#fing', className: 'active' }]
	};
	var n2 = {
		type: 'audio',
		src: 'audio/25047__radian__Kalimba_note2_preview.mp3',
		end: 800,
		10: [{ type: 'addClass', selector: '#fang', className: 'active' }],
		100: [{ type: 'removeClass', selector: '#fang', className: 'active' }]
	};
	var n3 = {
		type: 'audio',
		src: 'audio/25053__radian__Kalimba_note8_preview.mp3',
		end: 600,
		10: [{ type: 'addClass', selector: '#fong', className: 'active' }],
		100: [{ type: 'removeClass', selector: '#fong', className: 'active' }]
	};
	var n4 = {
		type: 'audio',
		src: 'audio/25049__radian__Kalimba_note4_preview.mp3',
		end: 800,
		10: [{ type: 'addClass', selector: '#fung', className: 'active' }],
		80: [{ type: 'removeClass', selector: '#fung', className: 'active' }]
	};
	var n5 = {
		type: 'audio',
		src: 'audio/25050__radian__Kalimba_note5_preview.mp3',
		end: 800,
		10: [{ type: 'addClass', selector: '#feng', className: 'active' }],
		100: [{ type: 'removeClass', selector: '#feng', className: 'active' }]
	};
	var n6 = {
		type: 'audio',
		src: 'audio/25054__radian__Kalimba_note9_preview.mp3',
		end: 800,
		10: [{ type: 'addClass', selector: '#foo', className: 'active' }],
		80: [{ type: 'removeClass', selector: '#foo', className: 'active' }]
	};
	var n1e = {
		type: 'audio',
		src: 'audio/25046__radian__Kalimba_note1_preview.mp3',
		10: [{ type: 'addClass', selector: '#fing', className: 'active' }],
		800: [{ type: 'removeClass', selector: '#fing', className: 'active' }]
	};
	
	var sequence = {
		type: 'sequence',
		end: 1560,
		1: [n1],
		286: [n2],
		696: [n3],
		933: [n6],
		1066: [n6],
		1133: [n5],
		1200: [n6],
		1333: [n5],
		1466: [n4]
	};
	
	var master = {
		type: 'sequence',
		end: 12000,
		1: [sequence],
		1601: [sequence],
		3201: [sequence],
		4801: [sequence],
		6401: [sequence],
		8001: [sequence],
		9601: [n1e]
	}
	
	// Make sequencer
	var sequencer = Sequencer( master );
	
	// Preload audio
	Sequencer.processes.audio(n1, 0, {addChildProcess: function(){}}, function(){
	  console.log('loaded n1');
	  jQuery('a[href=#go]').css({opacity: 1});
	  jQuery('body').removeClass('loading');
	  jQuery(this).unbind('canplaythrough');
	});
	Sequencer.processes.audio(n2, 0, {addChildProcess: function(){}}, function(){
	  console.log('loaded n2');
	  jQuery(this).unbind('canplaythrough');
	});
	Sequencer.processes.audio(n3, 0, {addChildProcess: function(){}}, function(){
	  console.log('loaded n3');
	  jQuery(this).unbind('canplaythrough');
	});
	Sequencer.processes.audio(n4, 0, {addChildProcess: function(){}}, function(){
	  console.log('loaded n4');
	  jQuery(this).unbind('canplaythrough');
	});
	Sequencer.processes.audio(n5, 0, {addChildProcess: function(){}}, function(){
	  console.log('loaded n5');
	  jQuery(this).unbind('canplaythrough');
	});
	Sequencer.processes.audio(n6, 0, {addChildProcess: function(){}}, function(){
	  console.log('loaded n6');
	  jQuery(this).unbind('canplaythrough');
	});
	
	jQuery(document).ready(function(){
		
		// Wait for button click
		
		jQuery('a[href=#go]')
		.bind('click', function(e){
			sequencer.play();
			sequencer = null;
			jQuery(this).css({opacity: 0.4});
			
			e.preventDefault();
		});
		
	});
    
  </script>
</body>
</html> 