<!DOCTYPE html>
<html>
<head>

  <link href="../css/webcss/reset.css" media="all" rel="stylesheet" type="text/css"/>
  <link href="../css/webcss/states.css" media="all" rel="stylesheet" type="text/css"/>
  <link href="../css/webcss/layer.css" media="all" rel="stylesheet" type="text/css"/>
  
  <style>
    html, body {
      width: 100%;
      height: 100%;
      font-family: 'Helvetica';
      color: #999999;
    }
    .test {
      width: 400px;
      height: 400px;
      background-color: #dddddd;
    }
    p {
      margin: 160px auto;
      text-align: center;
    }
  </style>
</head>
<body>
  
  <p>Loading layer transition test<br /><br />[click anywhere]</p>
  
  <div class="screen_layer layer loading_icon">
     
  </div>
  
  <script src="../js/jquery-1.4.2.js" type="text/javascript"></script>
  <script src="../js/jquery.extensions.js" type="text/javascript"></script>
  <script type="text/javascript">
    jQuery(document).ready(function(){
      
      var body = jQuery('body'),
          state = false;
      
      body
      .bind('click', function(){
        if (state) {
          state = false;
          body.addClass('transition');
          body.removeClass('loading');
        }
        else {
          state = true;
          body.addClass('transition');
          // Delay removal of hide to allow the browser
          // time to reflow, or the transition doesn't happen.
          // FF is particularly bad at this - needs min 20ms.
          var t = setTimeout(function(){
            clearTimeout(t);
            t = null;
            body.addClass('loading');
          }, 20);
        }
      });
      
      jQuery('body')
      .bind('transitionend webkitTransitionEnd oTransitionEnd', function(e){
        jQuery(e.target)
        .closest('.transition')
        .removeClass('transition');
      });
      
    });
    
  </script>
</body>
</html> 