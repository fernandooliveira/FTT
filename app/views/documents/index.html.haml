- session_key_name = ActionController::Base.session_options[:key]

<!-- app/views/documents/index -->

%div.action-zone.zone
  %div.wrap
    %a#wb-create-document-button.add-button.button= t('.buttons.new_document')
    -#%input#wb-documents-search.ui-corner-all{ :type => "text", :name => "wb-documents-search", :placeholder => "Search" }
    %ul.tabs.index
      %li>
        %ul.filter-bar.bar.index.state-public-hide{ :style => "float: right;" }
          %li>
            %a#wb-document-filter-owned-by-me.current.state-filter-tab{ :href => "#filter-author" }= t('.created_by_me')
          %li>
            %a#wb-document-filter-editor-rights.state-filter-tab{ :href => "#filter-editable" }= t('.editor_rights')
%div.content
  %div.wrap
    %div#wb-document-list-container.column.triple.of-four
      %div.loading-icon
    %div.column.last.of-four.state-public-hide{ :style => 'text-align: justify;' }>
      %h3 Your Webdocs
      %p Create your own new webdoc, or choose a webdoc to view from the list.
      %p You can <strong>invite</strong> other people to help you edit your webdocs, and when you're ready to show them to the world, choose <strong>sharing</strong>.
    
#wb-new-document-dialog{ :style => "display:none", :title => t('.create_new_document') }
  %form#wb-new-form.new-form{ :action => "", :title => t('.create_new_document') }
    %h4#new-document-dialog-header Create new webdoc
    %fieldset
      %div.stack
        %label{ :for => "name" }= t ".document_forms.name"
        %input#wb-new-document-name.ui-corner-all{ :type => "text", :name => "wb-new-document-name", :placeholder => "My new webdoc" }
      %div.stack
        %label{ :for => "category" }= t ".document_forms.category"
        %select#wb-new-document-category
      %div.stack
        %label{ :for => "description" }= t ".document_forms.description"
        %textarea#wb-new-document-description.ui-corner-all{ :rows => "3", :name => "wb-new-document-description" }
      
    %fieldset
      %legend= t ".document_forms.document_size_title"


      %div.shunt.column.one.of-two>
        %label{ :for => 'wb-new-document-size-width' }= t('.document_forms.document_size.width')
        %input#wb-new-document-size-width{ :type => "text" , :size => 6, :required => 'required', :'data-type' => 'cssvalue' }
      %div.shunt.column.two.of-two>
        %label{ :for => 'wb-new-document-size-height' }= t('.document_forms.document_size.height')
        %input#wb-new-document-size-height{ :type => "text" , :size => 6, :required => 'required', :'data-type' => 'cssvalue' }

      %div.shunt
        %ul
          %li
            %a{ :class => 'set_size', :href => '#set-classic-size', :'data-webdoc-size-name' => 'classic' }= t('.document_forms.document_size.classic')
          %li
            %a{ :class => 'set_size', :href => '#set-iphone-size', :'data-webdoc-size-name' => 'iphone' }= t('.document_forms.document_size.iPhone')
          %li
            %a{ :class => 'set_size', :href => '#set-ipad-size', :'data-webdoc-size-name' => 'ipad' }= t('.document_forms.document_size.iPad')
    
    %div.ui-actions
      %a{ :href => '#cancel', :class => 'cancel' } cancel
      %input{ :type => 'submit', :name => 'new-document', :value => 'Create' }

#wb-change-access-dialog.collaborate-dialog{ :style => "display: none" }
  %form#wb-change-form.column.one.triple.of-five>
    %h4 Invite new editors
    %p= t('.document_forms.change_access_dialog.add_editors_explanation')
    
    %fieldset
      %div.stack
        %label= t('.document_forms.change_access_dialog.add_editors')
        %textarea#wb-invitation-add-editors{ :rows => 1, :cols => 20}
        #wb-invitation-failed
      %div.stack
        %label= t('.document_forms.change_access_dialog.add_editors_message')
        %textarea#wb-invitation-add-editors-message{ :rows => 3, :cols => 20}
    
    %div.ui-actions.state-readonly-hide
      %a{ :href => '#cancel', :class => 'cancel' } close
      %input{ :type => 'submit', :name => 'new-document', :value => 'Add' }
  %div.column.last.double.of-five#wb-access-list{ :style => "overflow: hidden;" }>
    %h4 Current editors
    %ul#document_access_list.vertical.divided.index
  
#wb-share-document-dialog.share-dialog{ :style => "display:none", :title => t('.document_forms.share_document_dialog.title') }
  %form#wb-share-form
    -#.column.one.triple.of-five>
    %h4 Share
    
    %fieldset
      %div.shunt
        %input#unshare_webdoc_radio{ :type => "radio", :name => "share", :value => "off" }
        %label{ :for => "unshare_webdoc_radio" } don't share (only co-editors will see this document)
      %div.shunt
        %input#share_webdoc_radio{ :type => "radio", :name => "share", :value => "on" }
        %label{ :for => "share_webdoc_radio" } share (make it public)
    
    %fieldset.state-unshared-hide
      %label{ :for => "shared_webdoc_url" }= t('.document_forms.share_document_dialog.shared_address_label')
      %input#shared_webdoc_url{ :type => "text", :size => 40 }
    
    -#%fieldset
    -#  %div.stack
    -#    %label Email addresses
    -#    %textarea#wb-invitation-add-readers{ :rows => 1, :cols => 20}
    -#    #wb-readers-invitation-failed
    -#  
    -#  %div.stack
    -#    %label= t('.document_forms.change_access_dialog.add_readers_message')
    -#    %textarea#wb-invitation-add-readers-message{ :rows => 3, :cols => 20 }
    
    -#%div.ui-actions
    -#  %a{ :href => '#cancel', :class => 'cancel' } cancel
    -#  %input{ :type => 'submit', :name => 'new-document', :value => 'Make it so' }

  -##wb-document-share-tabs.column.last.double.of-five
  -#  %h4 Shared with
  -#  #wb-shared-users-list-tab.unshare-related
  -#  %ul#document_readers_list


= content_for :scripts do
  = include_javascripts :document_editor
  :javascript
    WebDoc.authData = {
      authToken:"#{protect_against_forgery? ? form_authenticity_token : ''}",
      sessionKeyName:"#{session_key_name}",
      cookiesSessionKeyName:"#{cookies[session_key_name]}"
    };
    WebDoc.Application.main(function() {
      var editor = new WebDoc.DocumentEditor();
      editor.start();
    });