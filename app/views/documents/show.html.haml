- document_title @document.title
- session_key_name = ActionController::Base.session_options[:key]
= render :partial => "layouts/main_editor_toolbar"

#board_container.hide-scroll.board-panel.panel
  #screen.screen.layer
  #document_loading
    %img{ :src => "/images/icons/waiting_bar.gif"}

#toolbar.toolbar-panel.panel
  %ul.panel-tools.tools.thumbs.index.icons-only.preview_hidden
    -# Whitespace is removed between lis to preserve layout
    %li#page-browser>
      %a{ :href => "#left-panel-toggle", :title => "Left Panel" }
        Left Panel

  %ul#pages-tools.tools.thumbs.index.icons-only
    -# Whitespace is removed between lis to preserve layout
    %li#page-browser>
      %a{ :href => "#pages-browser", :title => "Pages browser" }
        Pages
    -#%li#removePage.preview_hidden>
    -#  %a{ :href => "#" , :title => "Remove this page", :style => "background-position: 0 0; background-image: url('/images/icons/page_remove.png');" }
    -#    Delete
    %li#prev-page>
      %a{ :href => "#prev-page" , :title => "Previous page" }
        Prev
    %li#next-page>
      %a{ :href => "#next-page" , :title => "Next Page" }
        Next
    -#%li#layout_selector.preview_hidden>
    -#  %a{ :href => "#layouts" , :title =>"Choose layout" }
    -#    Layout
    -#%li#theme_selector.preview_hidden>
    -#  %a{ :href => "#themes" , :title =>"Change theme" }
    -#    Theme
    %li#add-page.preview_hidden>
      %a{ :href => "#new-page", :title => "Add new page" }
        Add
    
  %ul#view_tools.edit-tools.tools.thumbs.index.icons-only
    -# Whitespace is removed between lis to preserve layout
    %li#zoom_in>
      %a{ :href => "#zoom-in" , :title => "Zoom In" }
        Zoom in
    %li#zoom_out>
      %a{ :href => "#zoom-out" , :title => "Zoom Out" }
        Zoom out
    %li#tool_hand>
      %a.state_tool{ :href => "#move" , :title => "Move" }
        Move
  
  %ul#edit_tools.edit-tools.tools.thumbs.index.icons-only.preview_hidden
    -# Whitespace is removed between lis to preserve layout
    %li#undo>
      %a{ :href => "#undo" , :title => "Undo" }
        Undo
    %li#redo>
      %a{ :href => "#redo" , :title => "Redo" }
        Redo
    %li#move-back>
      %a{ :href => "#moveBack" , :title => "Move Back" }
        Move Back
    %li#move-front>
      %a{ :href => "#moveFront" , :title => "Move Front" }
        Move Front      
    %li#delete_item>
      %a{ :href => "#delete" , :title => "Delete" }
        Delete
  
  %ul#misc_tools.edit-tools.tools.thumbs.index.icons-only
    -# Whitespace is removed between lis to preserve layout
    %li#tool_arrow>
      %a.state_tool{ :href => "#select" , :title => "Select" }
        Select
    %li#html_snipplet.preview_hidden>
      %a{ :href => "#insert-html" , :title => "Insert an HTML snippet" }
        HTML
    %li#tool_text.preview_hidden>
      %a{ :href => "#insert-text" , :title => "Insert a Text box" }
        Text
    %li#tool_pen.preview_hidden>
      %a.state_tool{ :href => "#draw" , :title => "Draw" }
        Draw

  %ul#toggle_inspector_wrap.panel-tools.tools.thumbs.index.icons-only.preview_hidden
    -# Whitespace is removed between lis to preserve layout
    %li#toggle_inspector>
      %a{ :href => "#right-panel-toggle", :title => "Toggle Inspector" }
        Inspector
  
  %ul#right_bar_tools.panel-tools.tools.thumbs.index.icons-only.preview_hidden
    -# Whitespace is removed between lis to preserve layout
    %li#lib_view>
      %a{ :href => "#library", :title => "Show Library" }
        Library
    %li#item_inspector_view.current_right_item>
      %a{ :href => "#inspector", :title => "Show Inspector" }                      
        Item
    -#%li#page_inspector_view>
    -#  %a{ :href => "", :title => "Show Page inspector" }
    -#    Page

#left_bar.left-panel.panel
  #page_browser_left.pages-browser.inspector
    #page_browser_container.content
      %ul.page_browser_numbered_list.vertical.numbers.index
      %ul#page_browser_items.vertical.pages.index
    #page_browser_control_bar.foot
      %ul.thumbs.index.icons-only
        %li#add-page.action_button 
          %img{ :src => "/images/icons/new.png", :alt => "Add page"}
        %li#copyPage.action_button
          %img{ :src => "/images/icons/duplicate.png", :alt => "Duplicate page"}
        %li#removePage.action_button
          %img{ :src => "/images/icons/delete_page.png", :alt => "Delete page"}

#right_bar.right-panel.panel
  = render :partial => 'item_inspector'
  = render :partial => 'library'
  = render :partial => 'page_inspector'

:javascript
  $(function()
  {
    WebDoc.authData = {
      authToken:"#{protect_against_forgery? ? form_authenticity_token : ''}",
      sessionKeyName:"#{session_key_name}",
      cookiesSessionKeyName:"#{cookies[session_key_name]}"
    };
    $.ajaxSetup({data:{authenticity_token : WebDoc.authData.authToken}});
    $("body").css("overflow", "hidden");
    var editor = new WebDoc.PageEditor(#{@is_reader?'false':'true'});
    editor.load("#{@document.uuid}");
    
    // Set up default panel behaviour (show screen, show footer etc.)
    jQuery(".panel").panel();
  });Â   